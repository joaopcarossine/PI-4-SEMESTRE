{% load static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Criar Modelo de Fluxo</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@100..800&display=swap');
    </style>
</head>

<body>

{% include 'sidebar.html' %}
    <div class="main-content">
<div class="criar">
    <h1> <a href="{% url 'listar_modelos_fluxo' %}"> <img style="width: 30px; height: 30px; padding-right: 3px;" src="/static/img/back.png" > </a> Criar Modelo de Fluxo</h1>
    <hr>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <label for="num_etapas">Número de etapas:</label>
        <input style="width: 50px;" type="number" id="num_etapas" name="num_etapas" min="1" max="10" onchange="gerarCampos()" required>
        <div id="etapas_container"></div>
        <br>
        <button class="blue-button" type="submit">Salvar Modelo</button>
    </form>

    </div>
    </div>
</body>

<script>
    function gerarCampos() {
        const container = document.getElementById('etapas_container');
        const qtd = parseInt(document.getElementById('num_etapas').value);
        container.innerHTML = '';
        for (let i = 1; i <= qtd; i++) {
            container.innerHTML += `
                    <fieldset style="margin-top:10px; padding:10px; border:1px solid #ccc; border-radius: 5px;">
                        <legend>Etapa ${i}</legend>
                        <label>Nome da Etapa:</label><br>
                        <input type="text" name="etapa_nome_${i}" required><br>
                        <label>Setor:</label><br>
                        <select name="etapa_setor_${i}">
                            <option value="">—</option>
                            {% for setor in setores %}
                                <option value="{{ setor.id }}">{{ setor.nome }}</option>
                            {% endfor %}
                        </select>
                    </fieldset>
                `;
        }
    }
</script>

</html>